import:
  - recipe/laravel.php
  - contrib/yarn.php

config:
  application: robvankeilegom.be
  repository: git@gitlab.com:robvankeilegom/robvankeilegom.be.git
  shared_dirs:
    - public/images/projects

hosts:
  production:
    hostname: robvankeilegom.be
    deploy_path: ~/websites/robvankeilegom.be
    branch: master
    stage: production
    forwardAgent: true
  staging:
    hostname: robvankeilegom.be
    deploy_path: ~/websites/staging.robvankeilegom.be
    branch: develop
    stage: staging
    forwardAgent: true

tasks:
  deploy:
    - deploy:prepare
    - deploy:vendors
    - artisan:storage:link
    - artisan:view:cache
    - artisan:config:cache
    - artisan:migrate
    - yarn:install
    - yarn:prod
    - deploy:publish
  yarn:prod:
    - run: cd {{release_path}} && yarn prod

